-- generates a table of date ranges when arbitrage was most possible using the closing prices of aud and gbp

SELECT
    aud_usd.tm AS "Date",
    aud_usd.observed AS "AUD to USD",
    gbp_usd.observed AS "GBP to USD",
    gbp_aud.observed AS "GBP to AUD",
    (gbp_aud.observed * aud_usd.observed) - gbp_usd.observed AS "GBP to AUD to USD"
FROM aud_usd
    INNER JOIN gbp_usd ON aud_usd.tm = gbp_usd.tm
    INNER JOIN gbp_aud ON aud_usd.tm = gbp_aud.tm
ORDER BY
    (gbp_aud.observed * aud_usd.observed) - gbp_usd.observed DESC
LIMIT 10;

-- sample output

--     Date    |     AUD to USD     |     GBP to USD     |     GBP to AUD     |     GBP to AUD to USD Arbitrage     
-- ------------+--------------------+--------------------+--------------------+-------------------------------------
--  2013-12-16 | 0.9634894067377211 | 1.7000507602518815 | 1.2252576858863082 | -0.51952795937644938103356903975698
--  2008-08-12 | 0.9688057672158874 | 1.7000507602518815 | 1.2184649193762844 | -0.51959491920989590681250953922344
--  1992-03-31 | 1.0316905403114562 |  1.771652505543454 | 1.2099083367530081 | -0.52340151987140777377321375860478
--  1992-04-08 | 1.0190880107786517 |  1.784599959110669 | 1.2235079181270192 | -0.53773770865467555582714368398736
--  1992-04-04 |  1.015362743288727 |  1.774226882320392 | 1.2157867496152934 |  -0.5397623129769230377700289824982
--  1991-09-07 | 0.9433860290834251 | 1.7000507602518815 | 1.2271308722232046 | -0.54239263953955259502315853392454
--  1988-09-17 | 0.9392734749175031 | 1.7000507602518815 |  1.232488305032707 |  -0.5424071871886272719046277261083
--  1984-02-21 | 0.9264876782674788 | 1.7038689943998915 | 1.2502048183373555 | -0.54556963489969989758137715568660
--  1986-03-23 |  0.932581300032927 | 1.6772993583037994 | 1.2117634803898505 |  -0.5472313964294083777855533925865
--  1992-04-16 |  1.015314518567394 | 1.7915011878680442 | 1.2240949353906032 |  -0.5486598278611486484917264879392
-- (10 rows)